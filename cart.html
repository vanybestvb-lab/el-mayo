<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panier — Ela Mayo</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="layout">
    <header class="site-header">
      <div class="container inner">
        <a href="index.html" class="logo-link"><img src="public/images/Logo.png" alt="Ela Mayo" class="logo"></a>
        <nav class="nav-main">
          <a href="index.html">Accueil</a>
          <a href="story.html">Notre histoire</a>
          <a href="shop.html">Boutique</a>
          <a href="recipes.html">Recettes</a>
          <a href="distributors.html">Distributeurs</a>
          <a href="contact.html">Contact</a>
        </nav>
        <div class="header-actions">
          <a href="cart.html" class="btn-icon" aria-label="Panier">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
            <span class="cart-count" id="header-cart-count" style="display: none;">0</span>
          </a>
          <button type="button" class="btn-icon menu-toggle" id="menu-toggle" aria-label="Menu">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
          </button>
        </div>
      </div>
      <div class="mobile-menu" id="mobile-menu">
        <nav class="nav-main">
          <a href="index.html">Accueil</a>
          <a href="story.html">Notre histoire</a>
          <a href="shop.html">Boutique</a>
          <a href="recipes.html">Recettes</a>
          <a href="distributors.html">Distributeurs</a>
          <a href="contact.html">Contact</a>
        </nav>
      </div>
    </header>

    <main>
      <div class="container" style="padding-top: 2rem; padding-bottom: 2rem;">
        <div id="cart-empty" style="text-align: center; padding: 4rem 1rem;">
          <h1 class="page-title">Votre panier est vide</h1>
          <p class="text-muted mt-4">Découvrez nos mayonnaises et ajoutez vos favoris au panier.</p>
          <a href="shop.html" class="btn btn--primary btn--lg mt-6">Voir la boutique</a>
        </div>
        <div id="cart-content" style="display: none;">
          <h1 class="page-title">Panier</h1>
          <div style="display: grid; gap: 2rem; margin-top: 2rem;">
            <div id="cart-items"></div>
            <div class="card" style="position: sticky; top: 6rem;">
              <div class="card__content">
                <h2 style="font-weight: 600; margin: 0 0 1rem;">Récapitulatif</h2>
                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                  <div style="display: flex; justify-content: space-between; font-size: 0.875rem;">
                    <span class="text-muted">Sous-total</span>
                    <span id="cart-subtotal">0,00 €</span>
                  </div>
                  <div style="display: flex; justify-content: space-between; font-size: 0.875rem;">
                    <span class="text-muted">Livraison</span>
                    <span id="cart-shipping">—</span>
                  </div>
                  <p id="cart-threshold" class="text-muted" style="font-size: 0.75rem; display: none;"></p>
                  <div style="display: flex; justify-content: space-between; border-top: 1px solid rgba(210,39,1,0.1); padding-top: 1rem; font-weight: 600;">
                    <span>Total</span>
                    <span id="cart-total">0,00 €</span>
                  </div>
                </div>
                <a href="checkout.html" class="btn btn--primary btn--lg btn--full mt-6">Passer la commande</a>
                <a href="shop.html" class="btn btn--outline btn--full mt-2">Continuer mes achats</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="footer-grid">
          <div><p class="brand">Ela Mayo</p><p class="brand-desc">La mayonnaise premium.</p></div>
          <div><h4>Navigation</h4><ul><li><a href="story.html">Notre histoire</a></li><li><a href="shop.html">Boutique</a></li><li><a href="recipes.html">Recettes</a></li><li><a href="distributors.html">Distributeurs</a></li><li><a href="contact.html">Contact</a></li></ul></div>
          <div class="footer-bottom">© <span id="year"></span> Ela Mayo. Tous droits réservés.</div>
        </div>
      </div>
    </footer>
  </div>
  <script src="js/app.js"></script>
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    (function() {
      var CART_KEY = 'ela-mayo-cart';
      var SHIPPING_THRESHOLD = 50;
      var SHIPPING_COST = 4.9;
      function getCart() { try { return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); } catch(e) { return []; } }
      function renderCart() {
        var cart = getCart();
        var emptyEl = document.getElementById('cart-empty');
        var contentEl = document.getElementById('cart-content');
        var itemsEl = document.getElementById('cart-items');
        if (!cart.length) {
          if (emptyEl) emptyEl.style.display = 'block';
          if (contentEl) contentEl.style.display = 'none';
          return;
        }
        if (emptyEl) emptyEl.style.display = 'none';
        if (contentEl) contentEl.style.display = 'block';
        var subtotal = 0;
        var html = '<ul style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 1rem;">';
        cart.forEach(function(item) {
          var line = item.price * item.quantity;
          subtotal += line;
          html += '<li class="card"><div class="card__content" style="display: flex; gap: 1rem; flex-wrap: wrap;">';
          html += '<div style="width: 6rem; height: 6rem; flex-shrink: 0; overflow: hidden; border-radius: 0.5rem; background: rgba(210,39,1,0.05);"><img src="' + (item.image || 'public/images/1.png') + '" alt="" style="width: 100%; height: 100%; object-fit: cover;"></div>';
          html += '<div style="flex: 1; min-width: 0;"><a href="shop/' + (item.slug || 'classic-mayonnaise') + '.html" class="product-card h3" style="font-weight: 600; color: var(--color-ink); text-decoration: none;">' + item.name + '</a>';
          html += '<p style="font-size: 0.875rem; color: var(--color-red); margin-top: 0.25rem;">' + item.price.toFixed(2) + ' € l\'unité</p>';
          html += '<div style="margin-top: 0.5rem; display: flex; align-items: center; gap: 0.5rem;"><button type="button" class="cart-qty-minus" data-id="' + item.productId + '" style="width: 2rem; height: 2rem; border: 1px solid rgba(210,39,1,0.2); border-radius: 0.25rem; background: transparent; cursor: pointer;">−</button>';
          html += '<span class="cart-qty" style="width: 2rem; text-align: center;">' + item.quantity + '</span>';
          html += '<button type="button" class="cart-qty-plus" data-id="' + item.productId + '" style="width: 2rem; height: 2rem; border: 1px solid rgba(210,39,1,0.2); border-radius: 0.25rem; background: transparent; cursor: pointer;">+</button>';
          html += '<button type="button" class="cart-remove" data-id="' + item.productId + '" style="margin-left: 1rem; font-size: 0.875rem; color: rgba(44,42,38,0.6); text-decoration: underline; border: none; background: none; cursor: pointer;">Retirer</button></div></div>';
          html += '<div style="text-align: right; font-weight: 600;">' + line.toFixed(2) + ' €</div></div></li>';
        });
        html += '</ul>';
        if (itemsEl) itemsEl.innerHTML = html;
        var shipping = subtotal >= SHIPPING_THRESHOLD ? 0 : SHIPPING_COST;
        var total = subtotal + shipping;
        var subtotalEl = document.getElementById('cart-subtotal');
        var shippingEl = document.getElementById('cart-shipping');
        var totalEl = document.getElementById('cart-total');
        var thresholdEl = document.getElementById('cart-threshold');
        if (subtotalEl) subtotalEl.textContent = subtotal.toFixed(2) + ' €';
        if (shippingEl) shippingEl.textContent = shipping === 0 ? 'Offerte' : shipping.toFixed(2) + ' €';
        if (totalEl) totalEl.textContent = total.toFixed(2) + ' €';
        if (thresholdEl) {
          if (subtotal < SHIPPING_THRESHOLD) {
            thresholdEl.style.display = 'block';
            thresholdEl.textContent = 'Plus que ' + (SHIPPING_THRESHOLD - subtotal).toFixed(2) + ' € pour la livraison gratuite.';
          } else thresholdEl.style.display = 'none';
        }
        itemsEl.querySelectorAll('.cart-qty-minus').forEach(function(btn) {
          btn.addEventListener('click', function() {
            var id = btn.dataset.id;
            var c = getCart();
            var i = c.findIndex(function(x) { return x.productId === id; });
            if (i >= 0) {
              if (c[i].quantity <= 1) c.splice(i, 1); else c[i].quantity--;
              localStorage.setItem(CART_KEY, JSON.stringify(c));
              renderCart();
            }
          });
        });
        itemsEl.querySelectorAll('.cart-qty-plus').forEach(function(btn) {
          btn.addEventListener('click', function() {
            var id = btn.dataset.id;
            var c = getCart();
            var i = c.findIndex(function(x) { return x.productId === id; });
            if (i >= 0) { c[i].quantity++; localStorage.setItem(CART_KEY, JSON.stringify(c)); renderCart(); }
          });
        });
        itemsEl.querySelectorAll('.cart-remove').forEach(function(btn) {
          btn.addEventListener('click', function() {
            var id = btn.dataset.id;
            var c = getCart().filter(function(x) { return x.productId !== id; });
            localStorage.setItem(CART_KEY, JSON.stringify(c));
            renderCart();
          });
        });
      }
      renderCart();
    })();
  </script>
</body>
</html>
